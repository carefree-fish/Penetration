

中间件漏洞可以通过vulhub.org/#/environments查看 

## 解析漏洞

![image-20230425213534482](E:\AppData\Roaming\Typora\typora-user-images\image-20230425213534482.png)

IIS7.0&7.5、Nginx全版本：

​	使用：1.jpg/x.php

​	原因：正则匹配后面的x.php，但是不存在，则找上层路径1.jpg，把后面的当成类似伪协议的东西，并且还是将1.jpg以php脚本格式解析

apache2.4之前：

​	后缀名从后向前。.php.aaa.bbb

之后版本的解析漏洞，都是配置文件更改出现的问题

apache2.4.0~2.4.29：

​	cve_2017_15715

IIS5.x&6.0：

​	文件夹解析漏洞

IIS6.0：

​	将.asp、.asa、.cer、.cds以脚本来解析

Nginx0.8.41~1.4.3 & 1.5.0~1.5.7：

​	%00截断：1.jpg%00.php



#### 让图片解析成脚本格式

eg. /xxx.png只能访问图片，但是/xxx.png/XX.php能把图片用php格式运行

目前已知存在解析漏洞的平台：IIS6/7.x、Apache、Nginx



大部分文件上传都不允许上传脚本格式文件

能上传脚本格式文件的一般是图片压缩文件、音频文件



Apache低版本漏洞，x.php.xx.yyy如果最后的yyy无法识别，则向前解析，知道识别



## CMS漏洞

 eg. 通达OA



## 其他漏洞

### 编辑器漏洞

参见navisec.it/编辑器漏洞手册

编辑器：网站借用第三方编辑器来编辑文章之类，eg. Fckeditor、ueditor等，如下

![image-20230426202056261](E:\AppData\Roaming\Typora\typora-user-images\image-20230426202056261.png)

辨别编辑器类别：

1.进入会员中心，查看编辑器类别

2.根据扫描文件路径

3.看编辑器界面

利用：网上搜脚本，本地运行一下就行，比如会自动上传脚本文件

### CVE等漏洞



### 中间件漏洞

IIS6/7、Apache、Nginx的解析漏洞



### 安全修复