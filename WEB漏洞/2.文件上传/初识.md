环境：vulhub.org/#/environments/，github upload-labs

![image-20230419142939233](E:\AppData\Roaming\Typora\typora-user-images\image-20230419142939233.png)

![image-20230419143045099](E:\AppData\Roaming\Typora\typora-user-images\image-20230419143045099.png)

![image-20230419143337068](E:\AppData\Roaming\Typora\typora-user-images\image-20230419143337068.png)

文件上传漏洞还是要看 代码的过滤 是否完善。凡是存在文件上传功能的地方，都可以测试是否有文件上传漏洞。

## 危害

上传后门文件，获取网站shell



## 查找方式

### 黑盒分析：

扫描工具，获取上传地址

自己找，会员中心一般可以上传图片

后台的文件上传漏洞，拿到后台权限，进而拿到网站权限（后台权限！=网站权限）

### 白盒分析：

拿到代码后

代码审计，分析某个地方存在文件上传操作，分析是否存在漏洞



## 漏洞区分

拿到漏洞后，对文件上传类型进行区分：

来自编辑器的，来自第三方应用的，普通文件上传



文件上传测试顺序：

先看是否有waf

1.找上传点：scan字典扫描，会员中心

2.判断上传方式：黑名单，白名单

3.看中间件，是否存在解析漏洞。结合解析漏洞进行上传

4.没有解析漏洞，则是否属于网站，CMS，网上是否有公开漏洞

5.非CMS，看编辑器，网上搜是否有漏洞爆出

6.找不出编辑器，则找CVE，是否有相关漏洞爆出
