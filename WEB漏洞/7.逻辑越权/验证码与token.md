## 登录的防护



### Token

1.爆破：知道Token字符串的生成规律

2.回显：Token会在前端显示

3.固定：上次的Token可以操作下一次的数据包



### 验证码

1.爆破：存在

2.识别：识别图片

3.复用：和Token.固定差不多

4.回显：和Token.回显差不多

5.绕过：逻辑上有问题，可以绕过步骤





![image-20230909215448742](E:\AppData\Roaming\Typora\typora-user-images\image-20230909215448742.png)





## 验证码安全

### 分类

图片，手机或邮箱，语言，视频，操作等



### 绕过

是否前端验证

是否刷新验证码

是否上一个验证码下一个也能用

是否第一个验证码填写正确，之后就不检测

是否第一个验证码填写正确，之后n次（不填验证码）判定为正确

是否第一个验证码填写正确，之后1分钟，此验证码都判定为正确



### 工具

工具：

Pkav_Http_Fuzz(old)

插件：

captcha

另：authcheck检测越权漏洞的bp插件

使用场景：

bp中暴力破解账号密码时，自动识别验证码

调用其他网站的网络接口来批量发短信时，可能先要输一次验证码

（有时候网站1min只发一个短信，所以需要调攻击频率）



## Token安全

### 爆破

如果Token可以看出，是某种加密，可根据原内容来预测

### 回显

Token可以在元素中，搜索token发现。

上一次访问之后，服务器返回了token给前端浏览器

### 固定



### 使用场景

操作uid值，遍历来获取其他用户信息，实现水平越权，需要使用上一个请求返回的token值



## 实例

callback自定义返回调用安全

如某网站采用了微信的支付接口，获取了callback的返回值来确定是否支付

&callback=某url（搜inurl:callback）