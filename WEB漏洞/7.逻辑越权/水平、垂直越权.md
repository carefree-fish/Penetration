



![image-20230718154341555](E:\AppData\Roaming\Typora\typora-user-images\image-20230718154341555.png)

![image-20230718154259985](E:\AppData\Roaming\Typora\typora-user-images\image-20230718154259985.png)

![image-20230901092105773](E:\AppData\Roaming\Typora\typora-user-images\image-20230901092105773.png)

## 业务逻辑越权

分为水平越权、垂直越权、未授权访问

![image-20230718154536033](E:\AppData\Roaming\Typora\typora-user-images\image-20230718154536033.png)

### 水平越权

通过更换的某个ID之类的身份标识，从而使A账号获取（修改、删除等）B账号数据

### 垂直越权

使用低权限身份的账号，发送高权限账号才能有的请求，获得其高权限的操作

### 未授权访问

通过删除请求中的认证信息后重放该请求，依旧可以访问或完成操作



## 原理

前端安全造成：界面展示是通过前端判断

（防御：仅在进行操作时，才判断权限是否符合）

后端安全造成：数据库

​	管理员和普通用户同表：通过id、uid、type、user type、group id等来判断，如id中1~10为管理员

​	管理员和普通用户不同表：



## 检测

水平越权：

​	当前用户的操作，都抓包试试，看看是否需要用户凭证，是否能伪造

垂直越权：（当前为普通用户）

​	方式1：如果盲猜管理员用户的操作权限和数据包格式

​	方式2：网上找源码



## 利用

后端安全造成：数据库

​	管理员和普通用户同表：

​		数据包中存在用户编号、组编号等，可以通过更改来测试利用



## 防御

1.前后端同时对用户输入信息进行校验，双重验证机制

2.调用功能前，验证用户是否有权限调用相关功能

3.执行关键操作前，必须校验用户身份，验证用户是否具有操作数据的权限

4.将对象的ID等加密（数据包中），防止攻击者穷举ID，敏感数据特殊化处理

5.永远不要相信用户的输入，对于可控擦书进行严格的检查和过滤





![image-20230801161422755](E:\AppData\Roaming\Typora\typora-user-images\image-20230801161422755.png)

1.中通开发的越权检测工具，需要服务器

2.里面privilegechecker，需要jdk环境。里面有3个浏览器，通过多个用户登录来对比测试

4.bp的authz插件。将测试器里发送的数据包发送到authz模块。通过先登录的用户的用户凭证，来测试一些数据包，从而确定是否存在漏洞