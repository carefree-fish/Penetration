![image-20230406180317675](E:\AppData\Roaming\Typora\typora-user-images\image-20230406180317675.png)

![image-20230406181452042](E:\AppData\Roaming\Typora\typora-user-images\image-20230406181452042.png)

![image-20230406182120950](E:\AppData\Roaming\Typora\typora-user-images\image-20230406182120950.png)



## CDN

一般使用CDN加速域名。通过传统的域名反查询IP，查询的是CDN加速服务器的IP地址，而不是网站的真实IP地址。我们一般用这两种方法来判断域名是否采用CDN加速：

方法一：Ping多处。使用站长家的多址ping功能ping目标域名。获取多个独立IP地址时，采用CDN加速。

方法二：NSLOOKUP+域名。配合命令窗口中的NSLOOKUP+域名命令。当非权威响应中出现多个独立的IP地址时，说明采用了CDN加速。



那么如何找到CDN加速域名的真实IP呢？有几种方法：

方法一：DNS历史解析记录

查询域名历史解析记录，可以找到网站使用CDN之前的解析记录，从而获取真实IP。

方法二：子域名查询

域名CDN加速需要付费给对应的CDN加速公司。很多情况下，只有主域名采用CDN加速，而没有采用子域名。这时候先查询对应的子域名，再反向查询子域名，得到真实IP。

方法三：在国外很多地方ping

很多国内CDN厂商因为各种原因只做国产线，但是国外线可能很少。这时候我们或许可以通过外部主机直接访问来获取真实IP。

方法四：SSL证书查询

证书颁发机构 (CAS) 必须将他们发布的每个 SSL/TLS 证书发布到公共日志中。 SSL/TLS 证书通常包含域名、子域名和电子邮件地址。

方法五：邮寄

许多网站都有发送电子邮件的功能，例如通过电子邮件注册和订阅网站内容。这时候查看邮件源码就会包含服务器的真实IP。检查电子邮件标头信息以查找真实 IP 地址。



## 站点搭建分析

### 搭建习惯

##### 目录型站点

站点目录下还有其他站点，则分站点可以理解为另一个程序，其漏洞会影响整个网站运行

##### 端口类站点

web默认80，可能8080有另外一个，但是服务器相同

##### 子域名站点

baidu.com和www.baidu.com和bbs.baidu.com

www一般就是主网站，指向baidu.com

可以通过ping判断是否在同一个主机上：

ip相同则在同一个主机上，ip在同一个网段上则为同一个局域网上

##### 类似域名站点

很多网站会买多个域名，且域名相关联，

如改变后缀的.net/.com/.cn，或改域名的xy1/xy2/xy3之类

可以根据备案信息查，通过站长之家等

##### 旁注/C段站点

旁注：（服务器的站点在一个主机上）

10.0.0.1下有两个站点：www.a.com和www.b.com（可以通过在线旁注搜索）

则a.com和b.com相关联

C段：（服务器的站点相独立，不在同一个ip上）

10.0.0.1下有一个站点：www.a.com，10.0.0.2下有一个站点：www.b.com

（比较难搞）

##### 搭建软件特征站点

Inmap，Wmap，phpstudy，宝塔 之类一体化搭建网站

可以根据抓包请求头中server分辨，搭建软件搭建的网站的server通常会显式很全

自己一步步搭建的网站可能只有apache

搭建软件搭建的网站可能会显式apache、php、openssh



## WAF

分为软件级，硬件级

wafw00f：检测是否有waf

waf会对扫描工具进行拦截，扫后，ip被禁，再进就进不去（可以通过降低线程等解决）

也可以通过响应包的X-Powered-By判断（有的有，有的没有）

如：X-Powered-By：WAF/2.0



## APP

#### 漏了个大洞检测网址 + 抓包获取更多网址

bp中Intercept不监控，在HTTP History中查看历史数据包，尽量多点

有的网址，直接访问获取不到信息，网页源码也没有什么信息或都看不懂，那就要换条路

#### 扫端口，扫接口，测试接口部分

##### 扫端口：

1. 快扫：masnmapscan，准确度：nmap -sV（nmap比网站更全面）

2. 通过白引擎和黑引擎来搜索ip：

白引擎很难搜到东西，黑引擎有zoomeye，fofa等

可以搜到它的域名，端口的服务等

有的端口运行数据库服务，可以爆破等，有的端口运行openssh，也有漏洞可以利用

有时候网址打不开，是因为检测到可能有攻击的行为，所以屏蔽了ip，所以需要挂梯子，开代理池



![xmind](C:\Users\Administrator\Desktop\xmind.png)



GitHub监控

黑暗引擎实现域名端口等收集

SRC目标中的信息收集全覆盖

利用其他第三方接口获取更多信息



https://crt.sh 查证书

https://dnsdb.io

http://sc.ftqq.com/3.version

https://tools.ipip.net/cdn.php	查ip

https://github.com/bit4woo/teemo

https://securitytrails.com/domain/www.baidu.com/history/a





1.域名信息

2.微信公众号

3.IP

4.移动·app：反编译看源码（可能有壳）

5.旁站：同一台服务器的其他网站

6.系统

7.C段：C类地址

8.源码泄露





google语法：

site：域名。可用于查询子域名

inurl：url关键字。可用于查询子域名

intext：搜索<body>内的

filetype：限制文件后缀后缀名

intitle：网页标题

link：包含某个指定url的页面



CDN：导致域名搜出的IP为假IP



站库分离：数据库和网站不在同一台主机



天眼查、企查查



<?php @eval()?>：@防止报错

小马为了上传大马（网页木马）

蚁剑只能接收post数据

冰蝎、哥斯拉：免密
